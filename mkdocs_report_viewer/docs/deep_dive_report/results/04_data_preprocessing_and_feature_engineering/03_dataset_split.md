# 3.2.3 数据集划分

本节介绍研究中采用的数据集划分方法，包括训练集、验证集和测试集的划分策略，这是机器学习模型开发和评估的关键步骤。

## 数据集划分原则

在进行数据集划分时，我们遵循以下核心原则：

1. **代表性原则**：确保各子集具有相似的数据分布，能够代表总体数据
2. **独立性原则**：严格分离训练、验证和测试数据，避免信息泄露
3. **平衡性原则**：维持各子集中目标变量的分布平衡，避免分布偏差
4. **随机性原则**：采用随机划分方法，减少选择偏差

## 数据集划分方法

考虑到样本量（n=101）相对有限，我们采用了以下划分策略：

### 划分比例

采用7:1:2的比例进行划分：
- 训练集：70%（70个样本）
- 验证集：10%（10个样本）
- 测试集：20%（21个样本）

### 分层抽样

为确保各子集的目标变量分布一致，我们采用分层抽样（stratified sampling）方法，按以下变量进行分层：

- **PWV风险等级**：正常、边缘、异常三组
- **年龄组**：<45岁、45-60岁、>60岁三组
- **性别**：男性、女性两组

### 随机种子固定

为确保结果的可复现性，我们固定随机种子为2025，保证每次运行得到相同的划分结果。

## 交叉验证设计

除了固定的训练-验证-测试集划分外，在模型调优阶段，我们还采用了k折交叉验证方法：

1. **10折交叉验证**：将训练集划分为10个子集，轮流使用9个子集训练、1个子集验证
2. **重复交叉验证**：重复交叉验证3次，减少随机波动影响
3. **分层交叉验证**：保证每折中目标变量分布一致

交叉验证过程如下图所示：

![交叉验证示意图](../../../../output/figures/other/cross_validation_diagram.png)

## 数据泄露防控

为防止数据泄露（data leakage），我们采取了以下防控措施：

1. **特征转换分离**：所有特征转换（如标准化、归一化）仅基于训练集数据计算，然后应用于验证集和测试集
2. **特征选择隔离**：特征选择仅在训练集上进行，选定的特征集再应用于验证集和测试集
3. **超参数调优限制**：超参数调优仅使用训练集和验证集，测试集仅在最终模型评估时使用一次

## 数据集划分结果

最终划分得到的各子集样本分布如下表所示：

| 数据集 | 样本数 | 正常PWV比例 | 边缘PWV比例 | 异常PWV比例 | 平均年龄 |
|-------|-------|-----------|-----------|-----------|--------|
| 训练集 | 70 | 34.3% | 32.9% | 32.8% | 65.2岁 |
| 验证集 | 10 | 30.0% | 40.0% | 30.0% | 66.1岁 |
| 测试集 | 21 | 33.3% | 33.3% | 33.4% | 64.8岁 |
| 总体 | 101 | 33.7% | 33.7% | 32.6% | 65.3岁 |

验证结果显示，各子集在关键特征（PWV风险分布、年龄等）方面具有良好的一致性，满足模型开发和评估的要求。

## 数据集划分总结

通过科学合理的数据集划分方法，我们确保了模型训练和评估的有效性和可靠性。尽管样本量相对有限，但采用的分层抽样和交叉验证方法有效地平衡了数据分布，为后续模型构建提供了坚实基础。

[返回本章目录](./00_index.md)
[返回总目录](../../00_index.md) 