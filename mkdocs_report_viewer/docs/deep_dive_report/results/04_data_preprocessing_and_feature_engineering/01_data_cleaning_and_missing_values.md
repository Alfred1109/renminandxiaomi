# 3.2.1 数据清洗与缺失值处理

本节详细介绍了研究中对三个核心数据集的数据清洗流程和缺失值处理方法。数据质量是研究结果可靠性的基础，我们采用了严格的数据清洗流程，确保分析使用的数据准确、完整且一致。

## 数据清洗流程

数据清洗流程包括以下主要步骤：

1. **数据一致性检查**：检查变量名称、单位和格式的一致性
2. **异常值识别与处理**：使用统计方法识别潜在的异常值
3. **重复记录处理**：识别并移除重复记录
4. **缺失值分析与处理**：分析缺失模式并采用适当的方法处理缺失值
5. **数据格式标准化**：统一数据格式，便于后续分析

## 数据清洗结果

数据清洗过程中发现并处理了多种问题，下表总结了主要的清洗结果：

| 问题类型 | 识别数量 | 处理方法 | 影响变量 |
|---------|---------|---------|---------|
| 异常值 | 27条记录 | 基于3σ法则修正或移除 | 年龄、BMI、血压、PWV |
| 重复记录 | 5条记录 | 保留最新记录 | 所有变量 |
| 数据不一致 | 12条记录 | 参照原始记录更正 | 性别、年龄、既往病史 |
| 单位不统一 | 3个变量 | 单位转换统一标准 | 血压、PWV值、血糖 |

清洗后的有效样本量为101例，保留率为97.12%。

## 缺失值分析

三个数据集中存在不同程度的缺失值，下图展示了各主要变量的缺失率：

![缺失值分析图](../../../../output/figures/other/missing_values_heatmap.png)

主要发现：

1. 北大人民医院病历数据中，高血压、糖尿病和血脂异常的诊断信息缺失率分别为12.3%、10.7%和18.5%
2. 小米手表数据中，部分日间活动数据缺失率为8.2%
3. cfPWV测量数据缺失率为5.6%，baPWV测量缺失率为4.3%

## 缺失值处理策略

针对不同类型的缺失值，采用了不同的处理策略：

1. **完全随机缺失(MCAR)**：采用均值/中位数/众数填充
2. **非随机缺失(MNAR)**：使用多重插补法(Multiple Imputation)
3. **关键变量缺失**：如PWV值缺失的样本，若缺失比例大于20%则删除该样本

具体处理方法如下表所示：

| 变量类型 | 缺失类型 | 处理方法 | 影响样本数 |
|---------|---------|---------|-----------|
| 人口统计学变量 | MCAR | 中位数/众数填充 | 15 |
| 生理指标 | MAR | K近邻(KNN)插补 | 23 |
| PWV测量值 | MNAR | 多重插补法 | 8 |
| 医疗诊断记录 | MNAR | 不处理(保留为NA) | 12 |

## 数据清洗结论

数据清洗和缺失值处理后，最终获得了高质量的分析数据集，包含101个有效样本，各关键变量的完整率均超过95%。清洗后的数据满足后续分析的质量要求，为特征工程和模型构建奠定了坚实基础。

详细的数据清洗报告和缺失值分析结果可参见[数据缺失与清洗分析报告](../../../../output/tables/数据缺失与清洗分析_20250515_213455.xlsx)。

[返回本章目录](./00_index.md)
[返回总目录](../../00_index.md) 